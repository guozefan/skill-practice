<template>
  <div class="video-container">
    <div class="video-content">
      <div class="video-title">
        <h3>{{ state.videoInfo?.text }}</h3>
        <div class="video-info">
          <p><svg t="1700550284572" class="icon" viewBox="0 0 1024 1024" version="1.1"
              xmlns="http://www.w3.org/2000/svg" p-id="2666" width="24" height="24">
              <path
                d="M512 619.38c29.23 0 59.78-45.83 59.78-107.6s-30.56-107.6-59.78-107.6c-29.22 0-59.78 45.83-59.78 107.6s30.55 107.6 59.78 107.6z m0 71.72c-76.42 0-131.5-82.63-131.5-179.33S435.58 332.45 512 332.45s131.5 82.63 131.5 179.33S588.42 691.1 512 691.1z m0 71.74c169.63 0 346.7-150.95 346.7-251.06S681.63 260.72 512 260.72c-164.37 0-346.7 160.27-346.7 251.06S347.63 762.84 512 762.84z m0 71.73c-202.08 0-418.44-190.18-418.44-322.79S309.92 188.99 512 188.99c206.94 0 418.44 180.3 418.44 322.79S718.94 834.57 512 834.57z"
                fill="#707070" p-id="2667"></path>
            </svg>{{ state.videoInfo?.flow }}万</p>
          <p><svg t="1700550374522" class="icon" viewBox="0 0 1024 1024" version="1.1"
              xmlns="http://www.w3.org/2000/svg" p-id="3847" width="24" height="24">
              <path
                d="M184.32 891.667692c-12.603077 0-25.206154-2.363077-37.809231-7.876923-37.021538-14.966154-59.864615-49.624615-59.864615-89.009231v-275.692307c0-212.676923 173.292308-385.969231 385.969231-385.969231h78.76923c212.676923 0 385.969231 173.292308 385.969231 385.969231 0 169.353846-137.846154 307.2-307.2 307.2H289.083077l-37.021539 37.021538c-18.904615 18.116923-43.323077 28.356923-67.741538 28.356923zM472.615385 195.347692c-178.018462 0-322.953846 144.935385-322.953847 322.953846v275.692308c0 21.267692 15.753846 29.144615 20.48 31.507692 4.726154 2.363077 22.055385 7.876923 37.021539-7.08923l46.473846-46.473846c6.301538-6.301538 14.178462-9.452308 22.055385-9.452308h354.461538c134.695385 0 244.184615-109.489231 244.184616-244.184616 0-178.018462-144.935385-322.953846-322.953847-322.953846H472.615385z"
                fill="#707070" p-id="3848"></path>
              <path
                d="M321.378462 512m-59.076924 0a59.076923 59.076923 0 1 0 118.153847 0 59.076923 59.076923 0 1 0-118.153847 0Z"
                fill="#8a8a8a" p-id="3849"></path>
              <path
                d="M518.301538 512m-59.076923 0a59.076923 59.076923 0 1 0 118.153847 0 59.076923 59.076923 0 1 0-118.153847 0Z"
                fill="#707070" p-id="3850"></path>
              <path
                d="M715.224615 512m-59.076923 0a59.076923 59.076923 0 1 0 118.153846 0 59.076923 59.076923 0 1 0-118.153846 0Z"
                fill="#707070" p-id="3851"></path>
            </svg>{{ state.videoInfo?.comments }}</p>
          <p>2023-11-15 19:49:13</p>
        </div>
      </div>
      <div class="video">
        <video id="player"  controls playsInline>
          <source :src="getVideo(state.videoInfo.url)" type="video/mp4" />
          <track kind="captions" label="English" srclang="en" :src="getVtt('en')" default="">
          <track kind="captions" label="Français" srclang="fr" :src="getVtt('rf')">
          <!-- <track kind="captions" label="中文字幕" :src="getVtt()" srclang="zh" default /> -->
        </video>

        <div class="video-action">
          <p><svg t="1700550464537" class="icon" viewBox="0 0 1024 1024" version="1.1"
              xmlns="http://www.w3.org/2000/svg" p-id="4977" width="32" height="32">
              <path
                d="M411.904 153.728c19.797333-63.232 54.186667-90.24 122.026667-70.656l1.706666 0.554667c19.84 6.101333 42.666667 17.706667 64.085334 37.162666 33.706667 30.72 53.76 73.301333 53.76 126.805334 0 47.786667-2.773333 77.312-10.88 110.805333l-0.256 0.938667h175.488c107.264 0 149.888 72.362667 122.922666 192.682666l-2.304 9.856-5.461333 18.005334-20.608 67.114666-9.642667 30.677334-9.173333 28.672-17.066667 51.626666-11.648 33.621334-7.210666 20.053333-9.984 26.368-6.101334 15.232c-29.525333 71.253333-90.453333 103.978667-170.112 94.592l-387.114666-28.8a587.690667 587.690667 0 0 0-7.381334-0.341333l-15.36-0.341334H218.026667l-12.501334-0.213333-9.984-0.426667-8.32-0.768-3.712-0.554666-7.125333-1.408-11.52-3.029334c-59.349333-17.621333-90.24-67.925333-90.24-139.605333v-283.52c0-90.538667 54.954667-142.208 148.565333-142.208l75.776-0.042667 5.205334-3.968a293.632 293.632 0 0 0 72.234666-88.32l6.101334-11.946666c6.101333-12.544 11.093333-25.685333 15.829333-41.002667l0.768-2.602667z m88.661333 8.064c-1.834667-0.426667-2.645333 0.170667-3.541333 2.773333l-3.882667 14.933334-10.666666 38.442666-2.56 8.533334a366.933333 366.933333 0 0 1-20.565334 53.162666 387.754667 387.754667 0 0 1-72.618666 102.442667 333.141333 333.141333 0 0 1-49.28 42.026667l5.504-3.925334v417.408l336.682666 25.344c41.898667 4.906667 65.621333-6.101333 80.213334-36.096l2.858666-6.229333 5.76-14.378667 9.514667-25.173333 6.912-19.285333 11.221333-32.469334 8.064-24.064 17.365334-53.76 19.2-61.354666 15.445333-50.858667c18.986667-76.074667 7.808-94.592-38.357333-94.592h-217.685334a53.632 53.632 0 0 1-50.730666-71.125333l2.176-6.4 3.328-10.922667c10.282667-35.754667 13.226667-59.136 13.226666-108.629333 0-48.426667-26.88-72.96-57.045333-82.261334l-3.712-1.152z m-242.944 270.122667h-34.389333c-47.616 0-63.232 14.72-63.232 56.917333v283.52c0 38.016 9.941333 53.333333 33.792 59.008l1.493333 0.341333 3.754667 0.554667 5.12 0.426667 11.562667 0.256h28.586666l13.312 0.085333v-401.066667z"
                p-id="4978"></path>
            </svg></p>
          <p><svg t="1700550582378" class="icon" viewBox="0 0 1024 1024" version="1.1"
              xmlns="http://www.w3.org/2000/svg" p-id="8617" width="32" height="32">
              <path
                d="M723.07624 239.356169c-17.756912 16.022945-37.442863 37.825781-59.070497 65.381416h113.237117c-1.647269 19.47643-2.470904 37.56388-2.470904 54.246094 0 15.421475 0.823635 35.150775 2.470904 59.184289h-64.286849v-63.96715h-400.889703v73.809222H247.777652c1.649075-25.021514 2.463679-46.39989 2.463679-64.120678 0-19.147699-0.814604-38.857131-2.463679-59.14997h123.073771c-19.606478-20.578222-38.48505-42.816357-56.632105-66.716211 16.066294-10.606102 32.139812-21.204979 48.2043-31.811081 24.736132 24.736132 46.50465 52.795702 65.303749 84.171485-15.240853 10.485085-27.548411 15.26614-36.904611 14.355807h90.760562c0-29.154137-0.807379-61.97128-2.431167-98.447819h66.718017c-1.621982 31.930291-2.429361 64.747435-2.429361 98.447819h59.106621c26.036608-38.282754 42.1896-69.477915 48.439108-93.587291 25.464037 11.84336 49.497551 21.244716 72.089704 28.204068zM715.699653 533.60325a953.32637 953.32637 0 0 0-2.47271 69.024555c0 23.643371 0.823635 47.476395 2.47271 71.500877h-64.281431V583.100801H373.60229v100.882597H309.315441c1.649075-28.348564 2.47271-53.830664 2.47271-76.448104 0-22.56506-0.825441-47.207269-2.47271-73.930238l406.384212-0.001806z"
                p-id="8618"></path>
              <path
                d="M545.870168 609.536582c-18.797293 55.826533-38.492275 92.304877-59.070497 109.445869-20.580028 17.142799-46.338479 31.984478-77.289801 44.516006-30.942291 12.54056-76.924945 22.957009-137.924481 31.245736-4.000769-17.209629-15.222791-37.590973-33.658841-61.153065 48.197075-1.988644 86.671288-6.571015 115.435283-13.763368 28.762188-7.186935 54.896331-19.398763 78.382561-36.62826 23.493455-17.236722 37.910673-48.249455 43.248043-93.041812 23.627115 6.457223 47.252424 12.921671 70.877733 19.378894zM688.637115 511.713715H336.377979c1.649075-26.697683 2.47271-49.723328 2.47271-69.069711 0-19.216335-0.825441-39.760239-2.47271-61.615456h352.259136v130.685167z m-64.288656-47.026647v-34.206124H400.664829v34.206124h223.68363zM579.164152 649.228185c77.50474 30.306503 141.881901 62.533014 193.133288 96.684951-16.057263 14.615902-30.292053 30.06447-42.70979 46.356541-36.377196-26.777156-97.703657-57.585787-183.993833-92.443956 13.393094-19.899085 24.578991-36.76192 33.570335-50.597536z"
                p-id="8619"></path>
              <path
                d="M1023.999097 511.999097c0 282.770383-229.23052 511.999097-511.993678 511.999097C229.231423 1024 0.000903 794.771286 0.000903 511.999097 0.000903 229.235939 229.231423 0 512.003612 0 794.768577 0 1023.999097 229.235939 1023.999097 511.999097zM512.003612 76.802122c-240.356812 0-435.207812 194.849193-435.207811 435.196975 0 240.355006 194.851 435.206006 435.207811 435.206006 240.349588 0 435.198781-194.851 435.198781-435.206006 0-240.345975-194.849193-435.196975-435.198781-435.196975z"
                p-id="8620"></path>
            </svg></p>
          <p><svg t="1700550612068" class="icon" viewBox="0 0 1024 1024" version="1.1"
              xmlns="http://www.w3.org/2000/svg" p-id="9701" width="32" height="32">
              <path
                d="M326 862.5c-13.7 0-27.3-4.3-38.9-12.7-20.6-14.9-30.7-39.8-26.4-64.8l8.6-50.2c2.8-16.3 18.3-27.3 34.6-24.5 16.3 2.8 27.3 18.3 24.5 34.6l-8.5 49.7c-0.5 2.9 0.8 5.9 3.4 7.3 1.8 0.9 3.7 0.9 5.6-0.1l152.2-80a66.03 66.03 0 0 1 61.7 0l152.2 80c2.3 1.2 4.5 1 6.6-0.5 2.1-1.5 2.9-3.6 2.5-6.2L675 625.7c-3.7-21.5 3.4-43.4 19.1-58.7l123.1-120c1.6-1.5 2.2-3.3 1.9-5.3-0.5-2.9-2.9-5.1-5.9-5.5l-169.6-24.6c-21.6-3.1-40.3-16.7-49.9-36.3L517.6 221c-1-2-2.5-3.1-4.5-3.4-2.9-0.5-5.8 1.2-7.1 3.9l-75.9 153.7c-9.7 19.6-28.3 33.1-49.9 36.3l-170.1 24.7c-2.2 0.3-3.7 1.4-4.6 3.2-1.3 2.6-0.6 5.9 1.5 7.9l122.7 119.6c11.9 11.6 12.1 30.6 0.5 42.4-11.6 11.9-30.6 12.1-42.4 0.5l-123.1-120c-18.2-17.7-24.6-43.8-16.8-68 7.9-24.2 28.4-41.5 53.5-45.1L371.5 352c2.1-0.3 3.8-1.6 4.7-3.4l76.1-154.2c11.3-22.8 34-37 59.5-37 25.4 0 48.2 14.2 59.4 37l76.1 154.2c0.9 1.9 2.7 3.1 4.7 3.4l170.1 24.7c25.2 3.7 45.7 20.9 53.5 45.1 7.9 24.2 1.4 50.2-16.8 68L736 609.9c-1.5 1.4-2.2 3.5-1.8 5.6l29.1 169.4c4.3 25.1-5.8 49.9-26.4 64.8-20.6 14.9-47.3 16.9-69.8 5l-152.2-80c-1.8-1-4-1-5.9 0l-152.2 80c-9.7 5.2-20.3 7.8-30.8 7.8z"
                p-id="9702"></path>
            </svg></p>
          <p><svg t="1700550657025" class="icon" viewBox="0 0 1024 1024" version="1.1"
              xmlns="http://www.w3.org/2000/svg" p-id="10998" width="32" height="32">
              <path
                d="M550.528 544.128L640 539.776V678.4l178.005333-178.005333L640 322.389333v129.024l-72.618667 10.922667c-155.52 23.424-251.733333 73.557333-312.874666 164.437333 84.906667-50.602667 178.261333-76.928 296.021333-82.645333zM554.666667 629.376c-27.392 1.322667-53.034667 3.968-77.141334 7.808l-8.192 1.365333c-136.704 23.637333-224.810667 87.168-310.954666 176.128-26.154667 27.008-51.882667 59.648-51.882667 59.648-14.848 18.176-24.021333 14.037333-20.352-9.173333 0 0 4.394667-31.402667 11.690667-65.792C144.938667 577.066667 250.581333 423.68 554.666667 377.941333V209.066667a38.4 38.4 0 0 1 65.536-27.136l291.328 291.285333a38.4 38.4 0 0 1 0 54.314667l-291.328 291.285333A38.4 38.4 0 0 1 554.666667 791.637333v-162.261333z"
                p-id="10999"></path>
            </svg></p>
        </div>
      </div>
      <!-- <div class="footer">评论</div> -->
    </div>
    <div class="right-nav">
      <ul>
        <li v-for="item in videoList" :key="item.id" @click="handleTab(item)"
          :class="{ 'active': state.videoInfo.id === item.id }">
          <video width="300" height="100">
            <source :src="getVideo(item.url)" type="video/mp4">
            您的浏览器不支持 video 标签。
          </video>
          <div class="text_box">
            <el-tooltip effect="dark" :content="item.text" placement="top-start">
              <p class="title">{{ item.text }}</p>
            </el-tooltip>
            <div class="action">
              <p><svg t="1700550284572" class="icon" viewBox="0 0 1024 1024" version="1.1"
                  xmlns="http://www.w3.org/2000/svg" p-id="2666" width="24" height="24">
                  <path
                    d="M512 619.38c29.23 0 59.78-45.83 59.78-107.6s-30.56-107.6-59.78-107.6c-29.22 0-59.78 45.83-59.78 107.6s30.55 107.6 59.78 107.6z m0 71.72c-76.42 0-131.5-82.63-131.5-179.33S435.58 332.45 512 332.45s131.5 82.63 131.5 179.33S588.42 691.1 512 691.1z m0 71.74c169.63 0 346.7-150.95 346.7-251.06S681.63 260.72 512 260.72c-164.37 0-346.7 160.27-346.7 251.06S347.63 762.84 512 762.84z m0 71.73c-202.08 0-418.44-190.18-418.44-322.79S309.92 188.99 512 188.99c206.94 0 418.44 180.3 418.44 322.79S718.94 834.57 512 834.57z"
                    fill="#707070" p-id="2667"></path>
                </svg>{{ item.flow }} 万</p>
              <p><svg t="1700550374522" class="icon" viewBox="0 0 1024 1024" version="1.1"
                  xmlns="http://www.w3.org/2000/svg" p-id="3847" width="24" height="24">
                  <path
                    d="M184.32 891.667692c-12.603077 0-25.206154-2.363077-37.809231-7.876923-37.021538-14.966154-59.864615-49.624615-59.864615-89.009231v-275.692307c0-212.676923 173.292308-385.969231 385.969231-385.969231h78.76923c212.676923 0 385.969231 173.292308 385.969231 385.969231 0 169.353846-137.846154 307.2-307.2 307.2H289.083077l-37.021539 37.021538c-18.904615 18.116923-43.323077 28.356923-67.741538 28.356923zM472.615385 195.347692c-178.018462 0-322.953846 144.935385-322.953847 322.953846v275.692308c0 21.267692 15.753846 29.144615 20.48 31.507692 4.726154 2.363077 22.055385 7.876923 37.021539-7.08923l46.473846-46.473846c6.301538-6.301538 14.178462-9.452308 22.055385-9.452308h354.461538c134.695385 0 244.184615-109.489231 244.184616-244.184616 0-178.018462-144.935385-322.953846-322.953847-322.953846H472.615385z"
                    fill="#707070" p-id="3848"></path>
                  <path
                    d="M321.378462 512m-59.076924 0a59.076923 59.076923 0 1 0 118.153847 0 59.076923 59.076923 0 1 0-118.153847 0Z"
                    fill="#8a8a8a" p-id="3849"></path>
                  <path
                    d="M518.301538 512m-59.076923 0a59.076923 59.076923 0 1 0 118.153847 0 59.076923 59.076923 0 1 0-118.153847 0Z"
                    fill="#707070" p-id="3850"></path>
                  <path
                    d="M715.224615 512m-59.076923 0a59.076923 59.076923 0 1 0 118.153846 0 59.076923 59.076923 0 1 0-118.153846 0Z"
                    fill="#707070" p-id="3851"></path>
                </svg>{{ item.comments }}</p>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</template>
<script setup lang="ts">
import { reactive, ref, onMounted, onBeforeUnmount } from 'vue'
import { videoList } from '@/assets/js/videoList'
import Plyr from 'plyr';
import { cn } from '@/utils/i18n';

const player = ref()
const state = reactive({
  videoInfo: {
    url: '',
    text: ''
  }
})

// 初始化
onMounted(() => {
  initPlayer()
  state.videoInfo = videoList[0]
})

// 销毁
onBeforeUnmount(()=>{
  player.value.destroy()
})


// 切换视频
function handleTab(row: any) {
  state.videoInfo = row;
  player.value.source= {
    type: 'video',
    sources: getVideo(row.url),
  }
}

// 初始化视频
function initPlayer() {
  player.value = new Plyr('#player', {
    settings: ['captions', 'quality', 'speed', 'loop'],
    i18n: cn,
    autoplay: true,
    captions:{
      active:true,
    }
  });
  player.value.on('captionsenabled',(event:any)=>{
    console.log(event)
  })
  player.value.on('captionsdisabled',(event:any)=>{
    console.log(event)
  })
  player.value.airplay()
}

function getVideo(url: string) {
  return new URL(`/src/assets/video/${url}`, import.meta.url).href
}

function getVtt(url:string) {
  return new URL(`/src/assets/${url}.vtt`, import.meta.url).href
}
</script>
<style lang="scss" scoped>
.video-container {
  display: flex;
  justify-content: center;


  .video-content {
    margin-right: 20px;
    padding: 16px;
    box-sizing: border-box;

    .video-title {

      h3 {
        font-size: 18px;
        font-weight: 500;
        line-height: 36px;
        margin-bottom: 5px;
      }

      div {
        display: flex;
        color: #999;
        font-size: 14px;

        p {
          margin: 0 6px;
        }
      }

      .video-info {
        line-height: 36px;

        svg {
          margin-right: 5px;
          vertical-align: middle;
        }
      }
    }



    // 中间视频
    .video {
      width: 860px;

      #player {
        width: 860px;
        height: 600px;
      }

      .video-action {
        display: flex;
        margin-top: 16px;

        p {
          margin: 0 10px;
          overflow: hidden;

        }
      }

    }


  }

  // 右边视频列表

  .right-nav {

    ul {
      li {
        padding: 16px;
        display: flex;
        justify-content: space-between;

        video {
          width: 200px;
          height: 130px;
          border-radius: 16px;
        }

        .text_box {
          width: 160px;
          padding: 10px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;

          .title {
            line-height: 26px;
            margin-bottom: 10px;
            word-break: break-all;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;

          }

          .action {
            display: flex;
            justify-content: space-between;
            color: #999;
            font-size: 14px;

            svg {
              vertical-align: middle;
            }
          }
        }
      }
    }
  }
}
</style>
